## ç¬¬åç«  Symbol

åœ¨æœ¬ç« èŠ‚é˜®ä¸€å³°è€å¸ˆå°± `Symbol` çš„å®šä¹‰å’Œä½œç”¨å±•å¼€æè¿°ï¼Œå…¶ä¸­é‡ç‚¹è®²è§£äº†æ¦‚è¿°ã€å±æ€§åéå†ã€`for()` å’Œ `keyFor()` æ–¹æ³•ï¼Œæœ€åæ¥ä¸¤ä¸ªå®ä¾‹ã€‚

### æ¦‚è¿°

åœ¨ ES5 æ—¶ï¼Œå¦‚æœä½¿ç”¨äº†ä»–äººçš„æ•°æ®å¯¹è±¡ï¼Œä½†åˆæƒ³æ·»åŠ è‡ªå·±çš„æ•°æ®ï¼Œå¾ˆå®¹æ˜“ä¼šå› ä¸ºå±æ€§åå†²çªè€Œå¯¼è‡´æ•°æ®è¦†ç›–ã€‚å› ä¸º ES5 å¯¹è±¡çš„å±æ€§åéƒ½æ˜¯å­—ç¬¦ä¸²å‹ã€‚

ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒES6 æ¨å‡ºäº† Symbolï¼Œä»–æ˜¯ç¬¬7ç§æ•°æ®ç±»å‹ã€‚

> ğŸ“¦ æ‹“å±•
>
> å‰6ç§æ•°æ®ç±»å‹åˆ†åˆ«æ˜¯ undefinedã€nullã€å¸ƒå°”å€¼ï¼ˆbooleanï¼‰ã€å­—ç¬¦ä¸²ï¼ˆstringï¼‰ã€æ•°å€¼ï¼ˆnumberï¼‰ã€å¯¹è±¡ï¼ˆobjectï¼‰ã€‚

é€šè¿‡ Symbol å‡½æ•°ç”Ÿæˆï¼Œæ˜¯ç¬¬ä¸€æ— äºŒçš„ï¼Œä¸ä¼šä¸å…¶ä»–å±æ€§åé€ æˆå†²çªã€‚å¯ä»¥æ¥æ”¶ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä¸»è¦ç”¨äºæ§åˆ¶å°æ‰“å°åŒºåˆ†ã€‚

```js
let s = Symbol()
let b = Symbol('bar')

console.log(typeof s) // symbol
console.log(typeof b) // symbol(bar)
```

> âš ï¸ æ³¨æ„
>
> Symbol å‡½æ•°å‰ä¸èƒ½ä½¿ç”¨ new å‘½ä»¤ï¼Œå¦åˆ™ä¼šæŠ¥é”™ è¿™æ˜¯å› ä¸ºç”Ÿæˆçš„ Symbol æ˜¯ä¸€ä¸ªåŸå§‹ç±»å‹çš„å€¼ï¼Œä¸æ˜¯å¯¹è±¡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç”±äº Symbol å€¼ä¸æ˜¯å¯¹è±¡ï¼Œæ‰€ä»¥ä¸èƒ½æ·»åŠ å±æ€§ã€‚åŸºæœ¬ä¸Šï¼Œå®ƒæ˜¯ ä¸€ç§ç±»ä¼¼äºå­—ç¬¦ä¸²çš„æ•°æ®ç±»å‹ã€‚

è‹¥ Symbol çš„å‚æ•°æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œåˆ™ä¼šè°ƒç”¨å¯¹è±¡çš„ toString æ–¹æ³•è½¬ä¸ºå­—ç¬¦ä¸²åå†ç”Ÿæˆ Symbol å€¼ã€‚

```js
const obj = {
  toString() {
    return 'abc'
  }
}

const sym = Symbol(obj)
console.log(sym) // Symbol(abc)
```

Symbol å‡½æ•°çš„å‚æ•°åªè¡¨ç¤ºå¯¹å½“å‰ Symbol å€¼çš„æè¿°ï¼Œå› æ­¤ç›¸åŒå‚æ•°çš„ Symbol å‡½æ•°çš„è¿”å›å€¼æ˜¯ä¸ç›¸ç­‰çš„ã€‚

```js
const s1 = Symbol()
const s2 = Symbol()

s1 === s2 // false

const b1 = Symbol('bar')
const b2 = Symbol('bar')

b1 === b2 // false
```

æœ€åï¼ŒSymbol ä¸å¯ä»¥å‚ä¸è¿ç®—ï¼Œå¯ä»¥è½¬ä¸ºå¸ƒå°”å€¼å’Œå­—ç¬¦ä¸²ï¼Œä¸å¯è½¬ä¸ºæ•°å€¼ã€‚

```js
const sym = Symbol('abc')

console.log('symbol is:' + sym) // Uncaught TypeError: Cannot convert a Symbol value to a string

console.log(`symbol is: ${sym}`) // Uncaught TypeError: Cannot convert a Symbol value to a string

console.log(String(sym)) // abc
console.log(sym.toString()) // abc

console.log(Boolean(sym)) // true
console.log(!sym) // false

Number(sym) // Uncaught TypeError: Cannot convert a Symbol value to a number
```

### ä½œä¸ºå±æ€§åçš„Symbol

åœ¨ES6ä¸­ï¼ŒSymbolï¼ˆç¬¦å·ï¼‰æ˜¯ä¸€ç§æ–°çš„åŸºæœ¬æ•°æ®ç±»å‹ï¼Œå®ƒçš„ä¸»è¦ç‰¹ç‚¹æ˜¯å…¶å€¼æ˜¯å”¯ä¸€ä¸”ä¸å¯å˜çš„ã€‚è¿™ä½¿å¾—Symbolç‰¹åˆ«é€‚åˆä½œä¸ºå¯¹è±¡å±æ€§åï¼Œç”¨äºè§£å†³å±æ€§åå†²çªçš„é—®é¢˜ï¼Œä¿è¯å±æ€§ä¸ä¼šè¢«æ„å¤–ä¿®æ”¹æˆ–è¦†ç›–ã€‚

ä½¿ç”¨Symbolä½œä¸ºå¯¹è±¡å±æ€§åçš„å‡ ç§å†™æ³•ï¼š

1. æ–¹æ‹¬å·ç»“æ„

   ```js
   var mySymbol = Symbol();
   var a = {};
   
   a[mySymbol] = 'Hello!';
   
   console.log(a[mySymbol]); // è¾“å‡º: "Hello!"
   ```

2. æ–¹æ‹¬å·å®šä¹‰å±æ€§

   ```js
   var mySymbol = Symbol();
   
   var a = {
     [mySymbol]: 'Hello!'
   };
   
   console.log(a[mySymbol]); // è¾“å‡º: "Hello!"
   ```

3. ä½¿ç”¨Object.defineProperty

   ```js
   var mySymbol = Symbol();
   var a = {};
   
   Object.defineProperty(a, mySymbol, { value: 'Hello!' });
   
   console.log(a[mySymbol]); // è¾“å‡º: "Hello!"
   ```

æ³¨æ„äº‹é¡¹ï¼š

1. **ç‚¹è¿ç®—ç¬¦æ— æ³•ä½¿ç”¨Symbolä½œä¸ºå±æ€§å**

   å› ä¸ºç‚¹è¿ç®—ç¬¦åé¢æ€»æ˜¯å­—ç¬¦ä¸²ï¼Œä¸ä¼šå°†Symbolä½œä¸ºæ ‡è¯†ç¬¦ï¼Œè€Œæ˜¯å°†å…¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚åŒç†ï¼Œåœ¨å¯¹è±¡çš„ ä½¿ç”¨ Symbol å€¼å®šä¹‰å±æ€§æ—¶ï¼Œ mbol å€¼å¿…é¡»æ”¾åœ¨æ–¹æ‹¬å·ä¸­ã€‚

   ```js
   var mySymbol = Symbol();
   var a = {};
   
   a.mySymbol = 'Hello!'; // é”™è¯¯çš„å†™æ³•ï¼Œå±æ€§åå®é™…æ˜¯å­—ç¬¦ä¸² "mySymbol"
   
   console.log(a[mySymbol]); // undefined
   console.log(a['mySymbol']); // è¾“å‡º: "Hello!"
   
   a = {
     [mySymbol]: function() {}
   }
   ```

2. **Symbolä½œä¸ºå±æ€§åæ˜¯å…¬å¼€å±æ€§**

   ä½¿ç”¨Symbolä½œä¸ºå±æ€§åæ—¶ï¼Œå¹¶ä¸ä¼šä½¿å±æ€§æˆä¸ºç§æœ‰å±æ€§ï¼Œä»ç„¶å¯ä»¥é€šè¿‡å…¶ä»–æ–¹å¼è®¿é—®åˆ°è¿™äº›å±æ€§ã€‚

Symbolè¿˜å¯ä»¥ç”¨äºå®šä¹‰ä¸€ç»„å”¯ä¸€ä¸”ä¸å¯å˜çš„å¸¸é‡ï¼Œç¡®ä¿ä¸åŒå¸¸é‡ä¹‹é—´ä¸ä¼šå‘ç”Ÿå€¼ç›¸ç­‰çš„æƒ…å†µï¼Œä¾‹å¦‚æ—¥å¿—çº§åˆ«æˆ–é¢œè‰²å¸¸é‡ã€‚

```js
const LOG_LEVELS = {
  DEBUG: Symbol('debug'),
  INFO: Symbol('info'),
  WARN: Symbol('warn')
};

function log(level, message) {
  // çœç•¥å…·ä½“å®ç°
}

log(LOG_LEVELS.DEBUG, 'Debug message');
log(LOG_LEVELS.INFO, 'Info message');
```

è¿™ç§æ–¹å¼ä¿è¯äº†æ¯ä¸ªå¸¸é‡éƒ½æ˜¯ç‹¬ä¸€æ— äºŒçš„Symbolï¼Œå¯ä»¥ç”¨äºæ ‡è¯†ä¸åŒçš„æ—¥å¿—çº§åˆ«æˆ–å…¶ä»–åœºæ™¯ä¸‹çš„å¸¸é‡ã€‚

æ€»è€Œè¨€ä¹‹ï¼Œ`Symbol` ä½œä¸º ES6 å¼•å…¥çš„ä¸€ç§æ–°çš„åŸºæœ¬æ•°æ®ç±»å‹ï¼Œç”¨äºåˆ›å»ºå”¯ä¸€çš„æ ‡è¯†ç¬¦ï¼Œç‰¹åˆ«é€‚åˆä½œä¸ºå¯¹è±¡å±æ€§åæˆ–å¸¸é‡çš„å®šä¹‰ã€‚å®ƒçš„å”¯ä¸€æ€§å¯ä»¥æœ‰æ•ˆåœ°é˜²æ­¢å±æ€§åå†²çªï¼Œå¹¶ä¸”ä¿è¯äº†å¸¸é‡å€¼çš„ç‹¬ç‰¹æ€§ï¼Œæ˜¯ JavaScript è¯­è¨€ä¸­æ›´åŠ å®‰å…¨å’Œæ¸…æ™°çš„ç¼–ç¨‹å®è·µä¹‹ä¸€ã€‚

### å®ä¾‹ï¼šæ¶ˆé™¤é­”æœ¯å­—ç¬¦ä¸²

é­”æœ¯å­—ç¬¦ä¸²æ˜¯æŒ‡åœ¨ä»£ç ä¸­å¤šæ¬¡å‡ºç°ã€ä¸ä»£ç å¼ºè€¦åˆçš„å…·ä½“å­—ç¬¦ä¸²æˆ–å€¼ã€‚åœ¨ç¼–å†™é£æ ¼è‰¯å¥½çš„ä»£ç æ—¶ï¼Œåº”å°½é‡æ¶ˆé™¤é­”æœ¯å­—ç¬¦ä¸²ï¼Œç”¨å«ä¹‰æ¸…æ™°çš„å˜é‡æˆ–å¸¸é‡ä»£æ›¿ï¼Œä»¥æé«˜ä»£ç çš„å¯è¯»æ€§ã€å¯ç»´æŠ¤æ€§å’Œå®‰å…¨æ€§ã€‚

1. ä½¿ç”¨å‘½åçš„å¸¸é‡æˆ–å˜é‡

   æœ€ç®€å•çš„æ–¹æ³•æ˜¯å°†é­”æœ¯å­—ç¬¦ä¸²å®šä¹‰ä¸ºå‘½åçš„å¸¸é‡æˆ–å˜é‡ï¼Œä¾‹å¦‚ï¼š

   ```js
   // ä½¿ç”¨å‘½åçš„å¸¸é‡
   const SHAPE_TRIANGLE = 'Triangle';
   
   function getArea(shape, options) {
     let area = 0;
     switch (shape) {
       case SHAPE_TRIANGLE:
         area = 0.5 * options.width * options.height;
         break;
       // å…¶ä»–å½¢çŠ¶çš„å¤„ç†
     }
     return area;
   }
   
   getArea(SHAPE_TRIANGLE, { width: 100, height: 100 });
   ```

   å°†å­—ç¬¦ä¸² `'Triangle'` å®šä¹‰ä¸ºå¸¸é‡ `SHAPE_TRIANGLE`ï¼Œç”¨æ¥ä»£æ›¿åŸæ¥çš„é­”æœ¯å­—ç¬¦ä¸²ã€‚è¿™æ ·åšå¯ä»¥å‡å°‘ä»£ç ä¸­å­—ç¬¦ä¸²çš„é‡å¤å‡ºç°ï¼Œæé«˜ä»£ç çš„å¯ç»´æŠ¤æ€§ã€‚

2. ä½¿ç”¨å¯¹è±¡å±æ€§

   å¦ä¸€ç§æ–¹æ³•æ˜¯å°†é­”æœ¯å­—ç¬¦ä¸²ä½œä¸ºå¯¹è±¡çš„å±æ€§ï¼Œè¿™ç§æ–¹å¼ä¹Ÿå¯ä»¥é¿å…å­—ç¬¦ä¸²çš„ç›´æ¥å‡ºç°ï¼š

   ```js
   // ä½¿ç”¨å¯¹è±¡å±æ€§
   const shapeType = {
     triangle: 'Triangle'
   };
   
   function getArea(shape, options) {
     let area = 0;
     switch (shape) {
       case shapeType.triangle:
         area = 0.5 * options.width * options.height;
         break;
       // å…¶ä»–å½¢çŠ¶çš„å¤„ç†
     }
     return area;
   }
   
   getArea(shapeType.triangle, { width: 100, height: 100 });
   ```

   `shapeType` å¯¹è±¡ä¸­çš„ `triangle` å±æ€§å­˜å‚¨äº†å­—ç¬¦ä¸² `'Triangle'`ï¼Œåœ¨ `getArea` å‡½æ•°ä¸­ä½¿ç”¨ `shapeType.triangle` æ¥æ›¿ä»£åŸå§‹çš„é­”æœ¯å­—ç¬¦ä¸²ã€‚

3. ä½¿ç”¨Symbolä½œä¸ºå±æ€§å€¼

   å¦‚æœç¡®ä¿æ¯ä¸ªå±æ€§çš„å€¼å”¯ä¸€ä¸”ä¸å˜æ˜¯å…³é”®ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨Symbolä½œä¸ºå±æ€§å€¼ï¼š

   ```js
   // ä½¿ç”¨Symbolä½œä¸ºå±æ€§å€¼
   const shapeType = {
     triangle: Symbol()
   };
   
   function getArea(shape, options) {
     let area = 0;
     switch (shape) {
       case shapeType.triangle:
         area = 0.5 * options.width * options.height;
         break;
       // å…¶ä»–å½¢çŠ¶çš„å¤„ç†
     }
     return area;
   }
   
   getArea(shapeType.triangle, { width: 100, height: 100 });
   ```

   ç”±äº shapeType.triangle` çš„å€¼æ˜¯ä¸€ä¸ªSymbolï¼Œä¿è¯äº†å®ƒçš„å”¯ä¸€æ€§ã€‚è¿™ç§åšæ³•é€‚ç”¨äºéœ€è¦ç¡®ä¿å±æ€§å€¼ä¸ä¸å…¶ä»–ä»»ä½•å€¼å†²çªçš„æƒ…å†µï¼ŒåŒæ—¶èƒ½æœ‰æ•ˆåœ°æ¶ˆé™¤é­”æœ¯å­—ç¬¦ä¸²ã€‚

æ€»è€Œè¨€ä¹‹ï¼Œæ¶ˆé™¤é­”æœ¯å­—ç¬¦ä¸²å¯ä»¥é€šè¿‡ä½¿ç”¨å‘½åçš„å¸¸é‡ã€å¯¹è±¡å±æ€§æˆ–Symbolæ¥å®ç°ã€‚è¿™äº›æ–¹æ³•å¯ä»¥æé«˜ä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ï¼Œå‡å°‘ç”±äºå­—ç¬¦ä¸²æ‹¼å†™é”™è¯¯æˆ–ä¿®æ”¹æ—¶é—æ¼æ›´æ–°å¯¼è‡´çš„bugã€‚

### å±æ€§åçš„éå†

å‰é¢æœ‰ä»‹ç»åˆ°ï¼Œ`Symbol` å¹¶ä¸æ˜¯ç§æœ‰å±æ€§ï¼Œè€Œæ˜¯å…¬æœ‰å±æ€§ï¼Œä½†æ˜¯ä¸ä¼šè¢« `for...of` ã€`for...in` ã€`Object.keys()` ã€`Object.getOwnPropertyNames()` ç­‰æ–¹æ³•éå†è¿”å›ã€‚

è‹¥éœ€è¦è·å–æŸä¸ªå¯¹è±¡çš„ `Symbol` å±æ€§åï¼Œåˆ™éœ€è¦é€šè¿‡ `Object.getOwnPropertySymbols` æ–¹æ³•è·å–ã€‚è¯¥æ–¹æ³•è¿”å›çš„æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ¯ä¸€é¡¹æ˜¯å½“å‰å¯¹è±¡æ‰€æœ‰ç”¨ä½œå±æ€§åçš„ `Symbol` å€¼ã€‚

```js
let a = Symbol('a')
let b = Symbol('b')
let f = Symbol('f')

let obj = {
  [a]: 'hello',
  [b]: 'world',
}

Object.defineProperty(obj, f, {
  value: 'foo'
})

for (let i in obj) {
  console.log(i) // æ— è¾“å‡º
}

Object.getOwnPropertyNaames(obj) // []

let objSym = Object.getOwnPropertySymbols(obj)
console.log(objSym) // [Symbol(a), Symbol(b), Symbol(f)]
```

å¦å¤–ï¼Œ`Reflect.ownKwys` æ–¹æ³•å¯ä»¥è¿”å›æ‰€æœ‰ç±»å‹çš„é”®åï¼Œä»£ç å¦‚ä¸‹ï¼š

```js
let obj = {
  [Symbol('key')]: 1,
  value: 'tydumpling'
}

Reflect.ownKwys(obj) // ['value', Symbol('key')]
```

ç”±äºç”¨ `Symbol` å®šä¹‰çš„å±æ€§ä¸ä¼šè¢«å¸¸è§„æ–¹æ³•éå†ï¼Œå› æ­¤å¯ä»¥åˆ©ç”¨å…¶è¿™ä¸€ç‰¹æ€§æ¥å®šä¹‰ä¸€äº›éç§æœ‰ä½†åªå¸Œæœ›å†…éƒ¨ä½¿ç”¨çš„æ–¹æ³•ã€‚

### Symbol.for()ã€Symbol.keyFor()

`Symbol` ä¸ `Symbol.for()` éƒ½ä¼šç”Ÿæˆæ–°çš„ `Symbol` ï¼ŒäºŒè€…çš„åŒºåˆ«æ˜¯ `Symbol` æ¯æ¬¡ç”Ÿæˆéƒ½æ˜¯è¿”å›æ–°çš„ `Symbol` å€¼ï¼›è€Œ `Symbol.for()` ä¼šåœ¨å…¨å±€ä¸­æä¾›æœç´¢ï¼Œå¦‚æœå…¨å±€ä¸­å­˜åœ¨è¯¥ `key` å€¼çš„ `Symbol` å€¼ï¼Œåˆ™ä¼šè¿”å›åŒä¸€ä¸ª `Symbol` å€¼ã€‚

```js
Symmbol.for('bar') === Symmbol.for('bar') // true

Symbol('foo') === Symbol('foo') // false
```

`Symbol.keyFor()` åˆ™ä¼šè¿”å›å·²ç™»è®°çš„ `Symbol` ç±»å‹çš„ `key` ã€‚

```js
let s1 = Symbol.for('foo')
Symbol.keyFor(s1) // foo

let s2 = Symbol('bar')
Symbol.keyFor(s2) // undefined
```

> ğŸ“¦ æ‹“å±•
>
> `Symbol.for()` ä¸º `Symbol` å€¼ç™»è®°çš„åå­—æ˜¯å…¨å±€ç¯å¢ƒçš„ï¼Œå¯ä»¥åœ¨ä¸åŒçš„ iframe æˆ– service worker ä¸­å–åˆ°åŒä¸€ä¸ªå€¼ã€‚

### å®ä¾‹ï¼šæ¨¡å—çš„Singletonæ¨¡å¼

Singleton æ¨¡å¼ç¡®ä¿ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªå…¨å±€è®¿é—®ç‚¹ã€‚åœ¨ Node.js ä¸­ï¼Œæ¨¡å—æ–‡ä»¶å¯ä»¥è§†ä½œä¸€ä¸ªç±»ï¼Œå¦‚ä½•ä¿è¯æ¯æ¬¡åŠ è½½æ¨¡å—æ—¶éƒ½è¿”å›åŒä¸€ä¸ªå®ä¾‹å‘¢ï¼Ÿ

- æ–¹æ³•ä¸€ï¼šä½¿ç”¨å…¨å±€å˜é‡ `_foo`ã€‚

  ```js
  // mod.js
  function A() {
      this.foo = 'hello';
      if (!global._foo) {
          global._foo = new A();
          module.exports = global._foo;
      }
  }
  
  // ä½¿ç”¨æ–¹å¼
  const a = require('./mod.js');
  console.log(a.foo); // è¾“å‡º 'hello'
  ```

  **é—®é¢˜ï¼š** å…¨å±€å˜é‡ `_foo` å¯è¢«å…¶ä»–æ¨¡å—ä¿®æ”¹ï¼Œå¯èƒ½å¯¼è‡´å®ä¾‹å¤±çœŸã€‚

- æ–¹æ³•äºŒï¼šä½¿ç”¨ Symbol ä½œä¸ºé”®å

  ```js
  // mod.js
  const FOO_KEY = Symbol.for('foo');
  
  function A() {
      this.foo = 'hello';
      if (!global[FOO_KEY]) {
          global[FOO_KEY] = new A();
          module.exports = global[FOO_KEY];
      }
  }
  
  // ä½¿ç”¨æ–¹å¼
  const a = require('./mod.js');
  console.log(a.foo); // è¾“å‡º 'hello'
  ```

  **ä¼˜ç‚¹ï¼š** ä½¿ç”¨ `Symbol.for('foo')` ä½œä¸ºé”®åï¼Œå¤–éƒ¨æ— æ³•ç›´æ¥å¼•ç”¨åˆ°è¯¥ Symbolï¼Œå¯ä»¥é¿å…æ„å¤–è¦†ç›–ã€‚

  **é—®é¢˜ï¼š** å…¨å±€å˜é‡ä¾ç„¶å¯ä»¥è¢«æ”¹å†™ï¼Œä¾‹å¦‚ `global[Symbol.for('foo')] = 123;`ã€‚

- æ–¹æ³•ä¸‰ï¼šä½¿ç”¨å±€éƒ¨ Symbol

  ```js
  // mod.js
  const FOO_KEY = Symbol('foo');
  
  function A() {
      this.foo = 'hello';
      if (!global[FOO_KEY]) {
          global[FOO_KEY] = new A();
          module.exports = global[FOO_KEY];
      }
  }
  
  // ä½¿ç”¨æ–¹å¼
  const a = require('./mod.js');
  console.log(a.foo); // è¾“å‡º 'hello'
  ```

  **ä¼˜ç‚¹ï¼š** ä½¿ç”¨å±€éƒ¨ Symbolï¼Œå…¶ä»–è„šæœ¬æ— æ³•å¼•ç”¨åˆ° `FOO_KEY`ï¼Œé¿å…å¤–éƒ¨ä¿®æ”¹ã€‚

  **é—®é¢˜ï¼š** å¤šæ¬¡æ‰§è¡Œæ¨¡å—æ—¶ï¼Œæ¯æ¬¡å¾—åˆ°çš„ `FOO_KEY` éƒ½ä¸åŒï¼Œä¸è¿‡ä¸€èˆ¬æƒ…å†µä¸‹ Node.js ä¼šç¼“å­˜æ¨¡å—çš„æ‰§è¡Œç»“æœï¼Œä¸ä¼šå¤šæ¬¡æ‰§è¡ŒåŒä¸€ä¸ªè„šæœ¬ã€‚

> æ€»ç»“
>
> - **å…¨å±€å˜é‡æ–¹æ³•**å®¹æ˜“è¢«æ„å¤–è¦†ç›–ï¼Œä¸å®‰å…¨ã€‚
> - **Symbol ä½œä¸ºé”®å**å¯ä»¥ä¿è¯é”®åä¸è¢«å¤–éƒ¨è½»æ˜“ä¿®æ”¹ï¼Œä½†ä»å¯èƒ½è¢«æ”¹å†™ã€‚
> - **å±€éƒ¨ Symbol**å¯ä»¥é˜²æ­¢å¤–éƒ¨ä¿®æ”¹ï¼Œä½†å¤šæ¬¡æ‰§è¡Œè„šæœ¬æ—¶æ¯æ¬¡å¾—åˆ°çš„ Symbol ä¸åŒï¼Œä¸è¿‡ Node.js é€šå¸¸ä¼šç¼“å­˜æ¨¡å—æ‰§è¡Œç»“æœï¼Œä¸€èˆ¬ä¸ä¼šå½±å“å•ä¾‹å®ä¾‹çš„åˆ›å»ºã€‚

### å†…ç½®çš„Symbolå€¼

ES6 è¿˜æä¾›äº† 11ä¸ªå†…ç½®çš„ `Symbol` å€¼ï¼ŒæŒ‡å‘è¯­è¨€å†…éƒ¨ä½¿ç”¨çš„æ–¹æ³•ã€‚

- `Symbol.hasInstance` 

  æŒ‡å‘ä¸€ä¸ªå†…éƒ¨æ–¹æ³•ï¼Œå¯¹è±¡ä½¿ç”¨ `instanceof` è¿ç®—ç¬¦æ—¶ä¼šè°ƒç”¨è¯¥æ–¹æ³•ã€‚å¦‚ `foo instance Foo` å†…éƒ¨å®é™…ä¸Šæ˜¯ `Foo[Symbol.hasInstance](foo)` ã€‚

  ```js
  class Event {
    [Symbol.hasInstance] (foo) {
      return foo instanceof Array
    }
  }
  
  [1, 2, 3] instanceof new Event() // true
  {a: 1} instanceof new Event() // false
  
  class OwnNum {
    static [Symbol.hasInstance] (foo) {
      return foo % 2 === 0
    }
  }
  
  1 instanceof new OwnNum() // false
  2 instanceof new OwnNum() // true
  ```

- `Symbol.isConcatSpreadable`

  è¯¥å±æ€§æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºå¯¹è±¡æˆ–æ•°ç»„åœ¨ä½¿ç”¨ `concat` æ–¹æ³•æ—¶æ˜¯å¦å¯ä»¥å±•å¼€ã€‚

  æ•°ç»„é»˜è®¤æ˜¯ `true` æˆ– `undefined` ï¼Œè¡¨ç¤ºå¯ä»¥å±•å¼€ï¼›è‹¥æ‰‹åŠ¨ä¿®æ”¹ä¸º `false` ï¼Œåˆ™è¡¨ç¤ºä¸å¯å±•å¼€ã€‚

  ```js
  let arr1 = [1, 2]
  ['a', 'b'].concat(arr1, 'å¼€') // ['a', 'b', 1, 2, 'å¼€']
  
  let arr2 = [3, 4]
  arr2[Symbol.isConcatSpreadable] = false
  ['c', 'd'].concat(arr2, 'ä¸å¼€') // ['c', 'd', [3, 4], 'ä¸å¼€']
  ```

  å¯¹è±¡é»˜è®¤æ˜¯ `false` ä¸å¯å±•å¼€ï¼Œæƒ³è¦å±•å¼€éœ€è¦æ‰‹åŠ¨è®¾ç½®ä¸º `true` ã€‚

  ```js
  let obj1 = {length: 1, 0: 'a'}
  [1, 2].concat(obj, 'open') // [1, 2, obj, 'open']
  
  let obj2 = {length: 1, 0: 'b'}
  obj2[Symbol.isConcatSpreadable] = true
  [3, 4].concat(obj, 'open') // [3, 4, 'b', 'open']
  ```

  å¯¹äºç±»è€Œè¨€ï¼Œ`Symbol.isConcatSpreadable` å±æ€§å¿…é¡»å†™ä¸ºç±»çš„å®ä¾‹ã€‚

  ```js
  class A extends Array {
    constructor(args) {
      super(args)
      this[Symbol.isConcatSpreadable] = true
    }
  }
  class B extends Array {
    constructor(args) {
      super(args)
      this[Symbol.isConcatSpreadable] = false
    }
  }
  
  let a1 = new A()
  a1[0] = 1
  a1[1] = 2
  let b1 = new B()
  b1[0] = 3
  b1[1] = 4
  ['a', 'b'].concat(a1).concat(b1) // ['a', 'b', 1, 2, [3, 4]]
  ```

- `Symbol.species`

  `Symbol.species` æ˜¯ä¸€ä¸ªå†…ç½®çš„ Symbol å±æ€§ï¼Œç”¨äºå®šä¹‰åœ¨æ‰§è¡Œæ•°ç»„æ–¹æ³•æ—¶ï¼Œå¦‚ä½•åˆ›å»ºæ–°çš„æ´¾ç”Ÿç±»å®ä¾‹ã€‚è¿™ä¸ªå±æ€§å…è®¸å­ç±»è¦†ç›–çˆ¶ç±»çš„é»˜è®¤è¡Œä¸ºï¼Œæ§åˆ¶è¿”å›çš„å®ä¾‹ç±»å‹ã€‚

  é»˜è®¤æƒ…å†µä¸‹ï¼Œè‹¥æœªå®šä¹‰ `Symbol.species`ï¼Œè¿™äº›æ–¹æ³•å°†è¿”å›çˆ¶ç±»ï¼ˆå³è°ƒç”¨æ–¹æ³•çš„ç±»ï¼‰çš„å®ä¾‹ã€‚å¦‚æœå®šä¹‰äº†ï¼Œåˆ™è¿”å›ç”± `Symbol.species` æŒ‡å®šçš„æ„é€ å‡½æ•°çš„å®ä¾‹ã€‚

  ```js
  class MyArray extends Array {
    // ä½¿ç”¨ get è¯»å–å™¨å®šä¹‰ Symbol.species å±æ€§
    static get [Symbol.species]() {
      return Array;
    }
  }
  
  let a = new MyArray(1, 2, 3);
  let mapped = a.map(x => x * x);
  
  console.log(mapped instanceof MyArray); // false
  console.log(mapped instanceof Array);   // true
  ```

- `Symbol.match`

  å¯¹è±¡çš„ Symbol match å±æ€§æŒ‡å‘ ä¸ªå‡½æ•° str match myObject ï¼‰æ—¶ ï¼Œå¦‚æœè¯¥ å±æ€§å­˜åœ¨ ä¼šè°ƒç”¨å®ƒè¿”å›è¯¥æ–¹æ³•çš„è¿”å›å€¼ã€‚

  ```js
  String.prototype.match(regexp) //ç­‰åŒäº regexp[Symbol.match](this)
  
  class MyMatcher {
    [Symbol.match] (string) {
      return 'hello world'.indexOf(string)
    }
  }
  
  'e'.match(new MyMatcher()) // 1
  
  class BooleanMatch {
    [Symbol.match] (string) {
      return Boolean(string)
    }
  }
  
  1.match(new BooleanMatch()) // true
  ```

- `Symbol.replace`

  ä½¿ç”¨ `Symbol.replace` å±æ€§å¯ä»¥è‡ªå®šä¹‰å¯¹è±¡åœ¨å­—ç¬¦ä¸²çš„ `replace` æ–¹æ³•ä¸­çš„è¡Œä¸ºã€‚

  è¯¥å±æ€§å®šä¹‰çš„æ–¹æ³•ä¼šåœ¨å­—ç¬¦ä¸² `replace` æ–¹æ³•è°ƒç”¨æ—¶è¢«è°ƒç”¨ï¼Œæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼šç¬¬ä¸€ä¸ªæ˜¯å½“å‰ä½œç”¨çš„å­—ç¬¦ä¸²å¯¹è±¡ï¼Œç¬¬äºŒä¸ªæ˜¯æ›¿æ¢å€¼ã€‚

  ```js
  // å®šä¹‰ä¸€ä¸ªç©ºå¯¹è±¡ x
  const x = {};
  
  // ä½¿ç”¨ Symbol.replace å±æ€§å®šä¹‰ä¸€ä¸ªæ–¹æ³•
  x[Symbol.replace] = (...s) => console.log(s);
  
  // è°ƒç”¨å­—ç¬¦ä¸²çš„ replace æ–¹æ³•ï¼Œå¹¶ä¼ å…¥ x å¯¹è±¡ä½œä¸ºæœç´¢å€¼
  'Hello'.replace(x, 'World');
  
  // æ§åˆ¶å°è¾“å‡ºä¸ºï¼š[ 'Hello', 'World' ]
  ```

- `Symbol.search`

  ä½¿ç”¨ `Symbol.search` å±æ€§å¯ä»¥è‡ªå®šä¹‰å¯¹è±¡åœ¨å­—ç¬¦ä¸²çš„ `search` æ–¹æ³•ä¸­çš„è¡Œä¸ºã€‚

  è¯¥å±æ€§å®šä¹‰çš„æ–¹æ³•ä¼šåœ¨å­—ç¬¦ä¸² `search` æ–¹æ³•è°ƒç”¨æ—¶è¢«è°ƒç”¨ï¼Œæ¥æ”¶ä¸€ä¸ªå­—ç¬¦ä¸²å‚æ•°ï¼Œè¡¨ç¤ºå½“å‰è¿›è¡Œæœç´¢çš„å­—ç¬¦ä¸²ã€‚

  ```js
  // å®šä¹‰ä¸€ä¸ªè‡ªå®šä¹‰çš„æœç´¢ç±» MySearch
  class MySearch {
    constructor(value) {
      this.value = value;
    }
  
    // ä½¿ç”¨ Symbol.search å±æ€§å®šä¹‰ä¸€ä¸ªæ–¹æ³•
    [Symbol.search](string) {
      return string.indexOf(this.value);
    }
  }
  
  // è°ƒç”¨å­—ç¬¦ä¸²çš„ search æ–¹æ³•ï¼Œå¹¶ä¼ å…¥ MySearch ç±»çš„å®ä¾‹ä½œä¸ºæ­£åˆ™è¡¨è¾¾å¼å‚æ•°
  console.log('foobar'.search(new MySearch('foo'))); // è¾“å‡ºä¸º 0
  ```

- `Symbol.split`

  å½“å¯¹è±¡è¢« `String.propertype.split` æ–¹æ³•è°ƒç”¨æ—¶ä¼šè¿”å›è¯¥æ–¹æ³•çš„è¿”å›å€¼ã€‚

- `Symbol.iterator`

- `Symbol.toPrimitive`

- `Symbol.toStringTag`

- `Symbol.unscopables`