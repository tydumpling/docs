# æ¨¡å¼ä¿®é¥°

æ­£åˆ™è¡¨è¾¾å¼åœ¨æ‰§è¡Œæ—¶ä¼šæŒ‰ä»–ä»¬çš„é»˜è®¤æ‰§è¡Œæ–¹å¼è¿›è¡Œï¼Œä½†æœ‰æ—¶å€™é»˜è®¤çš„å¤„ç†æ–¹å¼æ€»ä¸èƒ½æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨æ¨¡å¼ä¿®æ­£ç¬¦æ›´æ”¹é»˜è®¤æ–¹å¼ã€‚

| ä¿®é¥°ç¬¦ | è¯´æ˜                                         |
| ------ | -------------------------------------------- |
| i      | ä¸åŒºåˆ†å¤§å°å†™å­—æ¯çš„åŒ¹é…                       |
| g      | å…¨å±€æœç´¢æ‰€æœ‰åŒ¹é…å†…å®¹                         |
| m      | è§†ä¸ºå¤šè¡Œ                                     |
| s      | è§†ä¸ºå•è¡Œå¿½ç•¥æ¢è¡Œç¬¦ï¼Œä½¿ç”¨`.` å¯ä»¥åŒ¹é…æ‰€æœ‰å­—ç¬¦ |
| y      | ä» `regexp.lastIndex` å¼€å§‹åŒ¹é…               |
| u      | æ­£ç¡®å¤„ç†å››ä¸ªå­—ç¬¦çš„ UTF-16 ç¼–ç                |

## i

å°†æ‰€æœ‰`tydumpling.com` ç»Ÿä¸€ä¸ºå°å†™

```js
let fn = "tydumpling.com tydumpling.COM";
fn = fn.replace(/tydumpling\.com/gi, "tydumpling.com");
console.log(fn);
```

## g

ä½¿ç”¨ `g` ä¿®é¥°ç¬¦å¯ä»¥å…¨å±€æ“ä½œå†…å®¹

```js
let fn = "tydumpling";
fn = fn.replace(/u/, "@");
console.log(fn); //æ²¡æœ‰ä½¿ç”¨ g ä¿®é¥°ç¬¦æ˜¯ï¼Œåªæ›¿æ¢äº†ç¬¬ä¸€ä¸ª

let fn = "tydumpling";
fn = fn.replace(/u/g, "@");
console.log(fn); //ä½¿ç”¨å…¨å±€ä¿®é¥°ç¬¦åæ›¿æ¢äº†å…¨éƒ¨çš„ u
```

## m

ç”¨äºå°†å†…å®¹è§†ä¸ºå¤šè¡ŒåŒ¹é…ï¼Œä¸»è¦æ˜¯å¯¹ `^`å’Œ `$` çš„ä¿®é¥°

å°†ä¸‹é¢æ˜¯å°†ä»¥ `#æ•°å­—`å¼€å§‹çš„è¯¾ç¨‹è§£æä¸ºå¯¹è±¡ç»“æ„ï¼Œå­¦ä¹ è¿‡åé¢è®²åˆ°çš„åŸå­ç»„å¯ä»¥è®©ä»£ç ç®€å•äº›

```js
let fn = `
  #1 js,200å…ƒ #
  #2 php,300å…ƒ #
  #9 tydumpling.com # tydumpling
  #3 node.js,180å…ƒ #
`;
// [{name:'js',price:'200å…ƒ'}]
let lessons = fn.match(/^\s*#\d+\s+.+\s+#$/gm).map(v => {
  v = v.replace(/\s*#\d+\s*/, "").replace(/\s+#/, "");
  [name, price] = v.split(",");
  return { name, price };
});
console.log(JSON.stringify(lessons, null, 2));
```

## u

æ¯ä¸ªå­—ç¬¦éƒ½æœ‰å±æ€§ï¼Œå¦‚`L`å±æ€§è¡¨ç¤ºæ˜¯å­—æ¯ï¼Œ`P` è¡¨ç¤ºæ ‡ç‚¹ç¬¦å·ï¼Œéœ€è¦ç»“åˆ `u` æ¨¡å¼æ‰æœ‰æ•ˆã€‚å…¶ä»–å±æ€§ç®€å†™å¯ä»¥è®¿é—® [å±æ€§çš„åˆ«å (opens new window)](https://www.unicode.org/Public/UCD/latest/ucd/PropertyValueAliases.txt)ç½‘ç«™æŸ¥çœ‹ã€‚

```js
//ä½¿ç”¨\p{L}å±æ€§åŒ¹é…å­—æ¯
let fn = "tydumpling2010.ä¸æ–­å­¦ä¹ å‰ç«¯ï¼ŒåŠ æ²¹ï¼";
console.log(fn.match(/\p{L}+/u));

//ä½¿ç”¨\p{P}å±æ€§åŒ¹é…æ ‡ç‚¹
console.log(fn.match(/\p{P}+/gu)); // [., ,, !]
```

å­—ç¬¦ä¹Ÿæœ‰ unicode æ–‡å­—ç³»ç»Ÿå±æ€§ `Script=æ–‡å­—ç³»ç»Ÿ`ï¼Œä¸‹é¢æ˜¯ä½¿ç”¨ `\p{sc=Han}` è·å–ä¸­æ–‡å­—ç¬¦ `han`ä¸ºä¸­æ–‡ç³»ç»Ÿï¼Œå…¶ä»–è¯­è¨€è¯·æŸ¥çœ‹ [æ–‡å­—è¯­è¨€è¡¨(opens new window)](http://www.unicode.org/standard/supported.html)

```js
let fn = `
å¼ ä¸‰:010-99999999,æå››:020-88888888`;
let res = fn.match(/\p{sc=Han}+/gu);
console.log(res); // ['å¼ ','ä¸‰','æ','å››']
```

ä½¿ç”¨ `u` æ¨¡å¼å¯ä»¥æ­£ç¡®å¤„ç†å››ä¸ªå­—ç¬¦çš„ UTF-16 å­—èŠ‚ç¼–ç 

```js
let str = "ğ’³ğ’´";
console.table(str.match(/[ğ’³ğ’´]/)); //ç»“æœä¸ºä¹±å­—ç¬¦"ï¿½"

console.table(str.match(/[ğ’³ğ’´]/u)); //ç»“æœæ­£ç¡® "ğ’³"
```

## lastIndex

RegExp å¯¹è±¡`lastIndex` å±æ€§å¯ä»¥è¿”å›æˆ–è€…è®¾ç½®æ­£åˆ™è¡¨è¾¾å¼å¼€å§‹åŒ¹é…çš„ä½ç½®

- å¿…é¡»ç»“åˆ `g` ä¿®é¥°ç¬¦ä½¿ç”¨
- å¯¹ `exec` æ–¹æ³•æœ‰æ•ˆ
- åŒ¹é…å®Œæˆæ—¶ï¼Œ`lastIndex` ä¼šè¢«é‡ç½®ä¸º 0

```js
let fn = `å‰ç«¯ä¹‹è·¯è¦åŠªåŠ›`;
let reg = /å‰ç«¯(.{2})/g;
reg.lastIndex = 10; //ä»ç´¢å¼•10å¼€å§‹æœç´¢
console.log(reg.exec(fn));
console.log(reg.lastIndex);

reg = /\p{sc=Han}/gu;
while ((res = reg.exec(fn))) {
  console.log(res[0]);
}
```

## y

æˆ‘ä»¬æ¥å¯¹æ¯”ä½¿ç”¨ `y` ä¸`g` æ¨¡å¼ï¼Œä½¿ç”¨ `g` æ¨¡å¼ä¼šä¸€ç›´åŒ¹é…å­—ç¬¦ä¸²

```js
let fn = "udunren";
let reg = /u/g;
console.log(reg.exec(fn));
console.log(reg.lastIndex); //3
console.log(reg.exec(fn));
console.log(reg.lastIndex); //3
console.log(reg.exec(fn)); //null
console.log(reg.lastIndex); //0
```

ä½†ä½¿ç”¨`y` æ¨¡å¼åå¦‚æœä» `lastIndex` å¼€å§‹åŒ¹é…ä¸æˆåŠŸå°±ä¸ç»§ç»­åŒ¹é…äº†

```js
let fn = "udunren";
let reg = /u/y;
console.log(reg.exec(fn));
console.log(reg.lastIndex); //1
console.log(reg.exec(fn)); //null
console.log(reg.lastIndex); //0
```

å› ä¸ºä½¿ç”¨ `y` æ¨¡å¼å¯ä»¥åœ¨åŒ¹é…ä¸åˆ°æ—¶åœæ­¢åŒ¹é…ï¼Œåœ¨åŒ¹é…ä¸‹é¢å­—ç¬¦ä¸­çš„ qq æ—¶å¯ä»¥æé«˜åŒ¹é…æ•ˆç‡

```js
let fn = `å‰ç«¯ä¹‹è·¯æ¸è¡Œæ¸è¿œï¼Œé€€è·¯å·²ç»é¥é¥æ— æœŸ`;

let reg = /(\d+),?/y;
reg.lastIndex = 7;
while ((res = reg.exec(fn))) console.log(res[1])
```
